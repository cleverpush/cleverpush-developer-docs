kind: pipeline
type: docker
name: default

# https://v1.docusaurus.io/docs/en/publishing
steps:
- name: Deploy GH Pages
  image: node
  pull: if-not-exists
  commands:
    #- mkdir -p $HOME/.ssh
    #- ssh-keyscan -t rsa github.com >> $HOME/.ssh/known_hosts
    #- echo "$GITHUB_PRIVATE_KEY > $HOME/.ssh/id_rsa"
    #- chmod 0600 $HOME/.ssh/id_rsa
    - cd website
    - npm i
    - npm run publish-gh-pages-ci
  environment:
    GIT_USER: $DRONE_COMMIT_AUTHOR
    CURRENT_BRANCH: master
    USE_SSH: true
    #GITHUB_PRIVATE_KEY: git_deploy_private_key
  when:
    branch: master
    #event: push
